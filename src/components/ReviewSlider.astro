---
import { getCollection } from "astro:content";
import type { Review } from "../types";
const allReviews: Review[] = await getCollection("reviews");
---

<div class="swiper w-full">
  <div class="swiper-wrapper pb-10">
    {allReviews.map((review) => (
      <div class="swiper-slide">
        <div class="rounded-3xl bg-white/90 p-8 text-center shadow-[var(--shadow-soft)] ring-1 ring-black/5">
          <p class="text-xl font-semibold text-[color:var(--color-forest)]">
            “{review.data.review}”
          </p>
          <p class="mt-4 text-sm uppercase tracking-[0.25em] text-[rgba(27,29,33,0.6)]">
            {review.data.author}
          </p>
        </div>
      </div>
    ))}
  </div>
  <div class="swiper-pagination"></div>
</div>

<script>
  import Swiper from "swiper";
  import { Pagination, Autoplay } from "swiper/modules";
  import "swiper/css";
  import "swiper/css/pagination";

  document.addEventListener("astro:page-load", () => {
    const swiperEl = document.querySelector<HTMLElement>(".swiper");
    if (!swiperEl) return;

    new Swiper(swiperEl, {
      modules: [Pagination, Autoplay],
      loop: true,
      slidesPerView: 1,
      spaceBetween: 32,
      autoplay: {
        delay: 3500,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      breakpoints: {
        1024: {
          slidesPerView: 2,
        },
      },
    });
  });
</script>
