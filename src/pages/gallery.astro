---
import Layout from "../layouts/Layout.astro";
import Section from "../components/Section.astro";
import Badge from "../components/Badge.astro";
import { Picture } from "astro:assets";
import { getCollection } from "astro:content";
import type { Gallery } from "../types";

const gallery: Gallery[] = await getCollection("gallery");
---

<Layout
  pageTitle="Gallery — St. George Pizza"
  description="Step inside St. George Pizza. Browse our gallery of dishes, cocktails, and the vibrant dining room."
>
  <Section contain={false} class="[&>.container]:pb-10">
    <div class="container">
      <div class="mx-auto max-w-3xl text-center space-y-4">
        <Badge tone="olive" title="Gallery" />
        <h1>Immerse yourself in the atmosphere</h1>
        <p class="text-lg text-[rgba(27,29,33,0.72)]">
          Every corner of our space is designed for connection — from the glow of the wood-fired oven to the terrazzo bar and the art curated by local creators.
        </p>
      </div>
    </div>
  </Section>

  <section class="container pb-16 lg:pb-24">
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      {gallery.map((item, index: number) => (
        <a
          href={item.data.image.src}
          class="gallery-lightbox group overflow-hidden rounded-[2rem] bg-white/80 shadow-[var(--shadow-soft)] ring-1 ring-black/5"
        >
          <Picture
            src={item.data.image}
            alt={item.data.alt}
            class="h-full w-full object-cover transition duration-500 group-hover:scale-105"
            loading={index < 3 ? "eager" : "lazy"}
            fetchpriority={index < 3 ? "high" : "auto"}
          />
        </a>
      ))}
    </div>
  </section>
</Layout>

<script>
  import GLightbox from "glightbox";
  import "../../node_modules/glightbox/dist/css/glightbox.min.css";

  document.addEventListener("astro:page-load", () => {
    GLightbox({
      selector: ".gallery-lightbox",
      touchNavigation: true,
      loop: true,
    });
  });
</script>
